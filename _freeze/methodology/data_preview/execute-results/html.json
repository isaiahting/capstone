{
  "hash": "7511d43791ebcb2337b4c29632b541b5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Data Preview\"\ndate: \"21st Feb, 2025\"\ndate-modified: \"last-modified\"\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Code Chunk\"\n    number-sections: true\nexecute: \n  eval: false #r will run through all codes\n  echo: true #r will display all code chunk\n  warning: false #for mark down\n  freeze: true #r will not render all existing  html files\n  message: false #avoid printing warning message\neditor: source\n---\n\n\n\n# Overview\n\nIn this section, the methodology will be explained thereafter Exploratory Data Analysis will be done.\n\n# Packages\n\n::: panel-tabset\n## The following packages are required for this section:\n\n| Package | Description |\n|-------------------------------------|-----------------------------------|\n| [**sf**](https://r-spatial.github.io/sf/) | For importing, managing, and handling geospatial data |\n| [**sfdep**](https://sfdep.josiahparry.com/) | Used to compute spatial weights, global and local spatial autocorrelation statistics |\n| [**tmap**](https://cran.r-project.org/web/packages/tmap/vignettes/tmap-getstarted.html) | For thematic mapping |\n| [**tidyverse**](https://www.tidyverse.org/) | For non-spatial data wrangling |\n| [**knitr**](https://cran.r-project.org/web/packages/knitr/index.html) | For dynamic report generation |\n| [**patchwork**](https://patchwork.data-imaginist.com/) | For plot manipulation |\n| [**leaflet**](https://rstudio.github.io/leaflet/) | For interactive maps |\n| [**scales**](https://scales.r-lib.org/) | For scaling graphs |\n\n## Code\n\nThe code chunk below, using `p_load` function of the [**pacman**](https://cran.r-project.org/web/packages/pacman/pacman.pdf) package, ensures that packages required are installed and loaded in R.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, readr, sf, httr,\n               jsonlite, rvest, dplyr, units,\n               lubridate, tmap, ggplot2,dplyr, tidyr)\n\n# -   Creates a package list containing the necessary R packages\n# -   Checks if the R packages in the package list have been installed\n# -   If not installed, will install the missing packages & launch into R environment.\n```\n:::\n\n\n:::\n\n# Data Preparation\n\n## Data Acquisition\n\n3 main spectrum of data will be required for this research, namely the Population Data, Master Plan 2019 Subzone boundary and Care Centres.\n\n![Figure x: Data Overview](/methodology/data/images/data_overview.png)\n\n### WebScraping of Care Centres\n\nDue to the lack of a centralised data of all care centres, web scarping is warranted in obtaining the information of the care centres. The geographical locations of the Care Centres alongside the centre names such as Active Ageing Centre, Day Care, Community Rehabilitation Centre, Centre-based Nursing were extracted using a web scraping tool, Web Scraper, available in Chrome web store as Seen in Figure x. As there is no centralised file that consist of the centre names and their locations, the location of each centre has to be manually extracted from the [Care Services](https://www.aic.sg/care-services/) webpage of the Agency of Integrated Care as seen in Figure x.\n\n#### Step 0: Download Web Scraper from Chrome web store\n\nWeb Scraper is used as it is free, works reasonably well and available in both Chrome and Firefox web store. In the below steps, Chrome will be the default web browser used.\n\n![*Figure x: Web Scraper*](/methodology/data/images/step0.png)\n\n#### Step 1: Navigate to Developer Tools in Chrome Web Browser\n\nAfter downloading the extension from Chrome Web Store, press onto the menu bar at the right of the browser and locate Developer Tools while onto the website you would like to scrape information from.\n\n![*Figure x: Web Scraper*](/methodology/data/images/step1.png)\n\n#### Step 2: Interface for Webscraper\n\nAfter clicking onto Developer Tools, click onto the Web Scraper in the menu bar (in black). Following which the below interface will appear.\n\n[![](/methodology/data/images/step2.png){width=\"499\"}](Figure%20x:%20Locate%20Developer%20Tools)\n\n#### Step 3: Create New Sitemap\n\nClick onto \"create new sitemap\", thereafter \"Create Sitemap\". Sitemap Name will be the overarching term used for these information; in this instance, it will be AAC. The Start URL will be the HTML link that you would like the information to be scraped from.\n\n![Figure x:](/methodology/data/images/step3.png){fig-align=\"center\"}\n\n#### Step 4: Add New Selector\n\nAfter creating a new sitemap, the following interface will appear. Click onto the \"Add new selector\" to select the information to scrape.\n\n![Figure x:](/methodology/data/images/step4.png){fig-align=\"center\"}\n\n#### Step 5: Selecting Whole Box\n\nFirstly, the id will be the column name. For Type, select Element Attribute from the drop down selection. Thereafter, press on Select under Selector and select two boxes of each centre as seen in the figure below (the remaining boxes will be highlighted through its intelligent function) and press onto Done Selecting in the green box.\n\n![Figure x:](/methodology/data/images/step5.png){fig-align=\"center\"}\n\n#### Step 6: Sitemap Interface\n\nAfter adding a new selector, the sitemap page will appear the selector that you've inputted.\n\n![Figure x: Step 6 - Create New Sitemap](/methodology/data/images/step6.png){fig-align=\"center\"}\n\n#### Step 7: Selecting Name of Care Centre\n\nFirstly, the id will be name (with reference to the name of care centre), serving as the column name. Text will be chosen under Type thereafter press Select under Selector and highlight the first 2 names of the care centres (The remaining care centres will be highlighted through its intelligent function) and press onto Done selecting in the green box. Multiple box will be selected as we would like to scrap multiple names and root parent selector will be root and press onto Save Selector.\n\n![Figure x: Step 7 - Selecting Name of Care Centre](/methodology/data/images/step7.png){fig-align=\"center\"}\n\n#### Step 8: Create New Sitemap\n\nA popup window will be prompted and Group selectors was selected.\n\n![Figure x: Step 8 - Create New Sitemap](/methodology/data/images/step8.png){fig-align=\"center\"}\n\n#### Step 9: Selecting Address of Care Centre\n\nSimilar to Step 7, the id will be address. Text will be chosen under Type thereafter press Select under Selector and highlight the first 2 addresses of the care centres (Remaining addresses will be highlighted through its intelligent function) and press onto Done selecting in the green box. Multiple box will be selected as we would like to scrap multiple addresses and parent selector will be wrapper_for_main_name (as we grouped selectors in step 8) and press onto Save Selector.\n\n![Figure x: Step 9 - Selecting Address of Care Centre](/methodology/data/images/step9.png){fig-align=\"center\"}\n\n#### Step 10: Data Preview\n\nPrior to data scraping, the data is previewed in ensuring each name of the care centre is correctly tagged to the address using the main website to verify.\n\n![Figure x: Step 10 - Data Preview](/methodology/data/images/step10.png){fig-align=\"center\"}\n\n#### Step 11: Commence Scraping\n\nHead over to sitemap aac and click onto Scrape. A new browser will appear indicating that it is in process of scraping. It will be closed automatically once the process has ended.\n\n![Figure x: Step 11 - Commence Scraping](/methodology/data/images/step11.png){fig-align=\"center\"}\n\n#### Step 11: Export Data\n\nExport data is selected upon clicking sitemap aac. 2 file options are offered: csv and xlsx. The former was chosen as CSV files are simple and portable which doesn't complicate data processing. Thereafter the data will be downloaded.\n\n![Figure x:](/methodology/data/images/step12.png){fig-align=\"center\"}\n\n#### Step 11: View CSV File\n\nIn ensuring the web scraping successful and accurate, the csv. file is opened and viewed.\n\n![Figure x: Step 11 - View CSV File](/methodology/data/images/step13.png){fig-align=\"center\"}\n\nThe above steps were repeated for each care centre.\n\n## Importing Data\n\n### Importing Geospatial Data\n\n#### Singapore's Master Plan 2019 Subzone Boundary\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz = st_read(dsn = \"data/subzone/masterplansubzone/\",\n               layer = \"MP14_SUBZONE_NO_SEA_PL\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmppa <- st_read(\"data/planningarea/MasterPlan2019PlanningAreaBoundaryNoSea.kml\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n#### Care Centres\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naac <- read_csv(\"data/carecentre/activeageingcentre.csv\") %>%\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnursing <- read_csv(\"data/carecentre/centrebasednursing.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrehab <- read_csv(\"data/carecentre/communityrehabcentre.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncounselling <- read_csv(\"data/carecentre/counselling.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndaycare <- read_csv(\"data/carecentre/daycare.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhospice <- read_csv(\"data/carecentre/dayhospice.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndementia <- read_csv(\"data/carecentre/dementia.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmaintenance <- read_csv(\"data/carecentre/maintenancedaycare.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnhrespite <- read_csv(\"data/carecentre/nhrespite.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnursinghome <- read_csv(\"data/carecentre/nursinghome.csv\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n### Importing Aspatial Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata2020 <- read_csv(\"data/popdata/respopagesex2024.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata2020 <- read_csv(\"data/popdata/respopagesex2023.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata2020 <- read_csv(\"data/popdata/respopagesex2022.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata2020 <- read_csv(\"data/popdata/respopagesex2021.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\npopdata2020 <- read_csv(\"data/popdata/respopagesex2011to2020.csv\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n### Cursory View\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(\"\")\n```\n:::\n\n\n\n### Checking for Missing Values\n\n\n\n::: {.cell}\n\n:::\n\n\n\n### Duplicate Check\n\nThe code chunk below identifies all rows in the dataframe that have an exact duplicate (i.e., another row with the same values in all columns) using *group_by_all()*.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nduplicate <- cbn %>% \n  group_by_all() %>% \n  filter(n()>1) %>% \n  ungroup()\n  \nduplicate\n```\n:::\n\n\n\nThe results returned 0 duplicated records.\n\n## Data Manipulation\n\n### Seperating postal code from address\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(stringr)\n\n# Active Ageing Centre\naac <- read_csv(\"data/carecentre/activeageingcentre.csv\")\naac <- mutate(aac, \n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Centre Based Nursing\nnursing <- read_csv(\"data/carecentre/centrebasednursing.csv\")\nnursing <- mutate(nursing,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Community Rehab Centre\nrehab <- read_csv(\"data/carecentre/communityrehabcentre.csv\")\nrehab <- mutate(rehab,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Counselling\ncounselling <- read_csv(\"data/carecentre/counselling.csv\")\ncounselling <- mutate(counselling,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Daycare\ndaycare <- read_csv(\"data/carecentre/daycare.csv\")\ndaycare <- mutate(daycare,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Day Hospice\nhospice <- read_csv(\"data/carecentre/dayhospice.csv\")\nhospice <- mutate(hospice,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Dementia\ndementia <- read_csv(\"data/carecentre/dementia.csv\")\ndementia <- mutate(dementia,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Maintenance Daycare\nmaintenance <- read_csv(\"data/carecentre/maintenancedaycare.csv\")\nmaintenance <- mutate(maintenance,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# NH Respite\nnhrespite <- read_csv(\"data/carecentre/nhrespite.csv\")\nnhrespite <- mutate(nhrespite,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n\n# Nursing Home\nnursinghome <- read_csv(\"data/carecentre/nursinghome.csv\")\nnursinghome <- mutate(nursinghome,\n  postal_code = str_extract(address, \"[0-9]{6}$\"),\n  address = str_remove(address, \"[,]?\\\\s*[0-9]{6}$\")\n)\n```\n:::\n\n\n\n### Labelling each dataset appropriately\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\naac <- aac %>%\n  mutate(label = \"aac\")\n```\n:::\n\n\n\n### Apend all Care Centres into one dataset\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncc_data <- bind_rows(\n  aac, \n  nursing, \n  rehab, \n  counselling, \n  daycare, \n  hospice, \n  dementia, \n  maintenance, \n  nhrespite, \n  nursinghome\n)\n\n# Optional: view the combined dataset structure\nstr(all_data)\n```\n:::\n\n\n\neach data has set adddress column with data like this 10 Tampines Street 62, 528519. i want to extra the last 6 digits from the right and make it to another column named \"postal_code\". do it for every dateset and row. give me the r code\n\n# Exploratory Data Analysis\n\n# References\n\nTan, K. (2023). Take-home Exercise 1: Geospatial Analytics for Public Good. Retrieved from <https://isss624-kytjy.netlify.app/take-home_ex/take-home_ex1/the1#background>\n\nUrban Redevelopment Authority. (2023). Master Plan 2019 Planning Area Boundary (No Sea) (2024) \\[Dataset\\]. data.gov.sg. Retrieved February 23, 2025 from https://data.gov.sg/datasets/d_6c6d7361dd826d97b91bac914ca6b2ac/view\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}